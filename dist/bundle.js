!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3"),require("lodash")):"function"==typeof define&&define.amd?define(["d3","lodash"],e):t.RadarChart=e(t.d3,t._)}(this,function(d,c){"use strict";var h="DRAGGING",a="CIRCLE_LEAVE_WHILE_DRAGGING",s="CIRCLE_HOVER",r="NEUTRAL",n="CIRCLE_ENTER",o="CIRCLE_LEAVE",l="DRAGGING",u="DRAGGING_END",O=2*Math.PI,p=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function a(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}}(),A="QUAD_1",P="QUAD_2",f=function(){function a(t,e,i){p(this,a),this.opts=t,this.axisIndex=i,this.axisOptions=e,this.dragActive=!1,this.axisTickTextElements=[],this.calculateAxisParameters()}return t(a,[{key:"calculateAxisParameters",value:function(){var i=this,t=this.opts,e=this.axisIndex,a=this.axisOptions,s=this.opts.dims,r=s.innerW,n=s.innerH,o=s.optsLeftChartOffset,l=s.optsTopChartOffset,c=this.opts.axis.maxAxisNo,h=o+r/2,u=l+n/2,p=o+r/2*(1-Math.sin(e*O/c)),d=l+n/2*(1-Math.cos(e*O/c));p<h&&d<=u?this.quad=A:h<=p&&d<=u?this.quad=P:p<=h&&u<=d?this.quad="QUAD_3":h<=p&&u<=d&&(this.quad="QUAD_4");var f=r/2*(1-t.axis.leftOffsetPLabel*Math.sin(e*O/c))-60*Math.sin(e*O/c)+o,x=n/2*(1-Math.cos(e*O/c))-20*Math.cos(e*O/c)+l,g=Math.abs(p-h)<1e-9?1/0:(d-u)/(p-h),y=g===1/0?0:d-g*p;this.gradient=g;this.maxValue=t.axis.useGlobalMax?t.axis.maxValue:a.axisValueMax,this.axisLength=Math.sqrt(Math.pow(p-h,2)+Math.pow(d-u,2)),this.angleFromNorth=180/Math.PI*(1-e*O/c)-180/Math.PI-90-180/Math.PI*10/this.axisLength/2,this.axis=a.axisId,this.label=a.label?a.label:a.axisId,this.opts.axis.textOverflow&&(this.textLineSpacingPx=this.opts.axis.textLineSpacingPx,this.labelLines=[],this.words=this.label.split(" "),this.lines=[this.words[0]],this.lines=this.words.slice(1).reduce(function(t,e){return t[t.length-1].length+e.length<=i.opts.axis.textOverflowWidthLimit?t[t.length-1]=t[t.length-1]+" "+e:t.push(e),t},this.lines)),this.x1=h,this.y1=u,this.x2=p,this.y2=d,this.labelX=f,this.labelY=x;var v=Math.sin(e*O/c),m=Math.cos(e*O/c);this.projectCordToAxis=function(t,e){return g===1/0?{x:h,y:e}:g<-2||0<=g||g<.145?{x:t,y:g*t+y}:{x:(e-y)/g,y:e}},this.projectValueOnAxis=function(t){return{x:o+r/2*(1-parseFloat(Math.max(t,0))/this.maxValue*v),y:l+n/2*(1-parseFloat(Math.max(t,0))/this.maxValue*m)}},this.cordOnAxisToValue=function(t,e){if(this.gradient===1/0){var i=Math.abs(this.y2-e);return(this.axisLength-i)*this.maxValue/this.axisLength}if(0<=this.gradient&&this.gradient<1e-8){var a=Math.abs(this.x2-t);return(this.axisLength-a)*this.maxValue/this.axisLength}return(2*(t-o)/r-1)*(this.maxValue/v)*-1}}},{key:"onRectMouseOver",value:function(){if(this.dragActive)return!1;this.axisTickTextElements.forEach(function(t){d.select(t).style("opacity",.9)})}},{key:"onRectMouseOut",value:function(){if(this.dragActive)return!1;this.axisTickTextElements.forEach(function(t){d.select(t).transition(200).style("opacity",0)})}}]),a}(),x=function(){function i(t){var e=this;p(this,i),this.axisMap=t.axisMap,this.series=c.cloneDeep(t.series),this.drawingContext=t.drawingContext,this.color=d.scaleOrdinal(d.schemeAccent),this.seriesIdent=t.seriesIdent,this.seriesIndex=t.seriesIndex,this.zoomConfig=t.zoomProps,this.opts=c.cloneDeep(t.areaOptions),this.opts.onValueChange=t.areaOptions.onValueChange,this.opts.colorScale=t.areaOptions.colorScale,this.onAreaUpdate=t.onAreaUpdate,this.label=this.series.label,this.polygonClassName="chart-poly-"+this.seriesIdent,this.polygonVertexLables="poly-lables-"+this.seriesIdent,this.circleOverlayClassName="circle-overlay"+this.seriesIdent,this.circleClassName="circle-"+this.seriesIdent,this.currentAreaOpacity=this.opts.areaHighlightProps.defaultAreaOpacity,this.points=this.series.data.map(function(t){return{cords:e.axisMap[t.axis].projectValueOnAxis(t.value),datum:c.cloneDeep(t)}}),this.polygonWrapper={points:this.points,svgStringRep:this.points.reduce(function(t,e){return t+e.cords.x+","+e.cords.y+" "},"")},this.setupZoomInterpolators(),this.onLegendOver=this.onLegendOver.bind(this),this.onLegendOut=this.onLegendOut.bind(this),this.hilightThisAreaRemove=this.hilightThisAreaRemove.bind(this),this.hilightThisArea=this.hilightThisArea.bind(this),this.state=r,this.postRenderQueue=[]}return t(i,[{key:"createEventHandler",value:function(e,i){return function(t){switch(e){case n:i.state!==h&&i.state!==a&&(i.state=s,d.select(t.circleRef).style("fill-opacity",i.opts.hoverCircleOpacity),i.hilightThisArea(),d.select(t.circleRef).transition(100).attr("r",i.opts.circleProps.defaultRadius*i.opts.circleProps.circleOverlayRadiusMult));break;case o:i.state===s?(d.select(t.circleRef).style("fill-opacity",i.opts.defaultCircleOpacity),i.hilightThisAreaRemove(),d.select(t.circleRef).transition(100).attr("r",i.opts.circleProps.defaultRadius),i.state=r):i.state===h&&(i.state=a);break;case l:i.draggingActions(t,i);break;case u:i.axisMap[t.datum.axis].dragActive=!1,i.axisMap[t.datum.axis].onRectMouseOut(),d.select(t.circleRef).style("fill-opacity",i.opts.defaultCircleOpacity),i.state=r,i.postRenderQueue.push(function(){return i.hilightThisAreaRemove()}),i.updatePositions()}}}},{key:"createOnMouseOverPolygon",value:function(){var i=this;return function(t){var e="."+i.polygonClassName;i.drawingContext().selectAll("polygon").transition(200).style("fill-opacity",i.opts.areaHighlightProps.hiddenAreaOpacity),i.drawingContext().selectAll(e).transition(200).style("fill-opacity",i.opts.areaHighlightProps.highlightedAreaOpacity)}}},{key:"createOnMouseOutPolygon",value:function(){var e=this;return function(t){d.select(this).transition(200).style("fill-opacity",e.opts.areaHighlightProps.defaultAreaOpacity)}}},{key:"draggingActions",value:function(t,e){var i=e.axisMap[t.datum.axis];e.axisMap[t.datum.axis].onRectMouseOver(),e.axisMap[t.datum.axis].dragActive=!0;var a=d.event,s=a.x,r=a.y,n=i.projectCordToAxis(s,r).x,o=i.projectCordToAxis(s,r).y;if(i.quad===A||i.quad===P){if(o<i.y2||o>i.y1)return}else if(o<i.y1||o>i.y2)return;this.state=h;var l=i.cordOnAxisToValue(n,o);t.datum.value=l,t.cords=e.axisMap[t.datum.axis].projectValueOnAxis(l),e.updatePositions(),c.isFunction(e.opts.onValueChange)&&e.opts.onValueChange(t)}},{key:"hilightThisArea",value:function(){var t="."+this.polygonClassName;this.drawingContext().selectAll("polygon").transition(200).style("fill-opacity",this.opts.areaHighlightProps.hiddenAreaOpacity).style("stroke-opacity",this.opts.areaHighlightProps.hiddenStrokeOpacity),this.drawingContext().selectAll("."+this.polygonVertexLables).style("opacity",this.opts.areaHighlightProps.highlightedLabelOpacity),this.drawingContext().selectAll(t).transition(200).style("fill-opacity",this.opts.areaHighlightProps.highlightedAreaOpacity).style("stroke-opacity",this.opts.areaHighlightProps.highlightedStrokeOpacity),this.currentAreaOpacity=this.opts.areaHighlightProps.highlightedAreaOpacity}},{key:"hilightThisAreaRemove",value:function(){this.drawingContext().selectAll("polygon").transition(200).style("fill-opacity",this.opts.areaHighlightProps.defaultAreaOpacity).style("stroke-opacity",this.opts.areaHighlightProps.defaultStrokeOpacity),this.drawingContext().selectAll("."+this.polygonVertexLables).style("opacity",this.opts.areaHighlightProps.hiddenLabelOpacity),this.currentAreaOpacity=this.opts.areaHighlightProps.defaultAreaOpacity}},{key:"isDragActive",value:function(){return this.state===a||this.state===h}},{key:"onLegendOver",value:function(){this.dragActive||this.hilightThisArea(this)}},{key:"onLegendOut",value:function(){this.dragActive||this.hilightThisAreaRemove(this)}},{key:"onZoomUpdateSizes",value:function(t){this.opts.lineProps.strokeWidth=this.zlop.areaLineLop(t),this.opts.circleProps.defaultRadius=this.zlop.circleRadiusLop(t)}},{key:"renderArea",value:function(){var t=this;this.area=this.drawingContext().selectAll(this.polygonClassName).data([this.polygonWrapper]).enter().append("polygon").attr("class",this.polygonClassName).style("stroke-width",this.opts.lineProps.strokeWidth+"px").style("stroke",function(){if(t.opts.useColorScale)return t.opts.lineColorScale(t.seriesIndex)}).style("stroke-opacity",this.opts.areaHighlightProps.defaultStrokeOpacity).attr("points",function(t){return t.svgStringRep}).style("fill",function(){if(t.opts.useColorScale)return t.opts.areaColorScale(t.seriesIndex)}).style("fill-opacity",this.currentAreaOpacity);var e=d.format(".2");this.areaVertexLabels=this.drawingContext().selectAll(this.polygonVertexLables).data(this.points).enter().append("svg:text").text(function(t){return e(t.datum.value)}).attr("x",function(t){return t.cords.x}).attr("y",function(t){return t.cords.y}).attr("class",this.polygonVertexLables).style("font-family",this.opts.labelProps["font-family"]).style("font-size",this.opts.labelProps["font-size"]).style("opacity",function(){return t.isDragActive()?1:t.opts.areaHighlightProps.defaultLabelOpacity}),this.opts.areaHighlight&&this.area.on("mouseover",this.createOnMouseOverPolygon()).on("mouseout",this.createOnMouseOutPolygon())}},{key:"renderCircles",value:function(){var t=this;this.circles=this.drawingContext().selectAll(this.circleClassName).data(this.points).enter().append("svg:circle").attr("r",function(){return t.isDragActive()?t.opts.circleProps.circleOverlayRadiusMult*t.opts.circleProps.defaultRadius:t.opts.circleProps.defaultRadius}).attr("alt",function(t){return Math.max(t.value,0)}).attr("cx",function(t){return t.cords.x}).attr("cy",function(t){return t.cords.y}).attr("class",this.circleClassName).style("fill",function(){if(t.opts.useColorScale)return t.opts.lineColorScale(t.seriesIndex)}).style("fill-opacity",function(){return t.isDragActive()?t.opts.hoverCircleOpacity:t.opts.defaultCircleOpacity}).each(function(t){t.circleRef=this}),this.circleOverylays=this.drawingContext().selectAll(this.circleOverlayClassName).data(this.points).enter().append("svg:circle").attr("r",this.opts.circleProps.defaultRadius*this.opts.circleProps.circleOverlayRadiusMult).attr("cx",function(t){return t.cords.x}).attr("cy",function(t){return t.cords.y}).attr("opacity",0).attr("class",this.circleOverlayClassName).attr("pointer-events","all").each(function(t){t.overlayRef=this}),this.series.circleHighlight&&this.circleOverylays.on("mouseover",this.createEventHandler(n,this)).on("mouseout",this.createEventHandler(o,this)),this.series.dragEnabled&&this.circleOverylays.call(d.drag().subject(function(t){return this}).on("drag",this.createEventHandler(l,this)).on("end",this.createEventHandler(u,this))),this.circles.append("svg:title").text(function(t){return t.datum.value})}},{key:"remove",value:function(){this.series.showCircle&&(this.circleOverylays.each(function(t){d.select(t.circleRef).on("mouseover",null).on("mouseout",null).on("drag",null).on("end",null).remove()}),this.circles.each(function(t){d.select(t.circleRef).remove()})),this.removeArea()}},{key:"removeArea",value:function(){this.area.on("mouseover",null).on("mouseout",null),this.areaVertexLabels.remove(),this.area.remove()}},{key:"render",value:function(){for(this.renderArea(),this.series.showCircle&&this.renderCircles();0<this.postRenderQueue.length;)this.postRenderQueue.pop()()}},{key:"setupZoomInterpolators",value:function(){var t=this.zoomConfig.scaleExtent.maxZoom;this.zlop={};this.zlop.areaLineLop=d.scaleLog().base(8).domain([1,t]).range([this.opts.lineProps.strokeWidth,this.opts.lineProps.maxZoomStroke]),this.zlop.circleRadiusLop=d.scaleLog().base(8).domain([1,t]).range([this.opts.circleProps.defaultRadius,this.opts.circleProps.maxZoomRadius])}},{key:"updatePositions",value:function(){this.polygonWrapper.svgStringRep=this.points.reduce(function(t,e){return t+e.cords.x+","+e.cords.y+" "},""),this.onAreaUpdate()}}]),i}();return function(){function e(t){p(this,e),this.rootElement=d.select(t.rootElement),this.rootElId=this.rootElement.attr("id"),this.setOps(t),this.areas=[]}return t(e,[{key:"setOps",value:function(t){var i=this;this.opts=c.merge({enableZoom:!0,zoomProps:{scaleExtent:{minZoom:1,maxZoom:12}},data:[],dims:{width:500,height:500,translateXp:.05,translateYp:.05,legendSpaceP:.1,innerPaddingP:.1},legend:{interactive:!0,legendWidthP:.9,legendHeightP:.2,legendWOverlap:1.1,legendTopOffset:20,textYOffset:9,textOffsetP:.75,colorScale:d.scaleOrdinal(d.schemeAccent),iconHeightP:.02,iconWidthP:.02,iconSpacingP:.05,title:"Test title",scaleTextWithSize:!0,titleScale:null,labelScale:null,titleProperties:{fontSize:12,fill:"#404040"},labelTextProperties:{"font-size":"11px",fill:"#737373"}},levels:{levelsNo:2,noTicks:3,levelsColor:null},point:{radius:5},showLegend:!0,axis:{config:[],colorScale:null,useGlobalMax:!1,maxValue:.6,leftOffsetPLabel:.85,textOverflow:!0,textOverflowWidthLimit:10,textLineSpacingPx:10,scaleTextWithSize:!0,tickScale:null,axisTitleScale:null,axisLabelProps:{"font-family":"sans-serif",fontAize:11,fill:"#808080"},ticks:{fill:"#737373",fontSize:10,"font-family":"sans-serif"}},area:{areaHighlight:!1,areaHighlightProps:{defaultAreaOpacity:0,highlightedAreaOpacity:.7,hiddenAreaOpacity:.1,defaultStrokeOpacity:.8,highlightedStrokeOpacity:1,hiddenStrokeOpacity:.2,defaultLabelOpacity:0,highlightedLabelOpacity:1,hiddenLabelOpacity:0},labelProps:{"font-family":"sans-serif","font-size":"10px"},defaultCircleOpacity:.3,hoverCircleOpacity:.5,circleProps:{defaultRadius:5,maxZoomRadius:1,circleOverlayRadiusMult:1.5},useColorScale:!0,areaColorScale:d.scaleOrdinal(d.schemeAccent),lineColorScale:d.scaleOrdinal(d.schemeAccent),onValueChange:null,lineProps:{strokeWidth:2,maxZoomStroke:.5}},rootElement:null},t),this.opts.axis.maxAxisNo=this.opts.axis.config.length;var e=this.opts.dims;e.paddingW=e.width*e.translateXp/2,e.paddingH=e.paddingW,e.legendW=e.width*e.legendSpaceP,e.chartContainerW=e.width-e.paddingW-e.legendW,e.chartContainerH=e.height-2*e.paddingH,e.innerPadding=e.chartContainerH*e.innerPaddingP,e.innerW=e.chartContainerW-2*e.innerPadding,e.innerH=e.chartContainerH-2*e.innerPadding,e.optsLeftChartOffset=e.innerPadding,e.optsTopChartOffset=e.innerPadding;var a=this.opts.legend;a.width=e.legendW*a.legendWidthP,a.height=e.height*a.legendHeightP,a.iconSpacing=a.iconSpacingP*e.height,a.iconHeight=a.iconHeightP*e.height,a.iconWidth=a.iconWidthP*e.height,this.data=this.opts.data,this.axisConfig=this.opts.axis.config,this.axisParameters=this.axisConfig.map(function(t,e){return new f(i.opts,t,e)}),this.axisMap=this.axisParameters.reduce(function(t,e){return t[e.axis]=e,t},{})}},{key:"render",value:function(){this.renderAxis(),this.renderArea(),this.opts.showLegend&&this.renderLegend()}},{key:"renderAxis",value:function(){var o=this,s=this.opts,t=this.opts.dims,r=t.width,e=t.height,i=t.paddingH,a=t.paddingW;this.rootSvg=this.rootElement.append("svg").attr("width",r).attr("height",e),this.rootSvg.append("g").attr("class","root"+this.rootElId).attr("transform","translate("+a+","+i+")"),this.opts.enableZoom&&(this.zoom=d.zoom().on("zoom",function(t){o.drawingContext().attr("transform",d.event.transform),o.areas.forEach(function(t){return t.onZoomUpdateSizes(d.event.transform.k)}),o.onUpdateArea()}).translateExtent([[0,0],[r,e]]).scaleExtent([this.opts.zoomProps.scaleExtent.minZoom,this.opts.zoomProps.scaleExtent.maxZoom]),this.rootSvg.call(this.zoom)),this.drawingContext=function(){var t=this.rootElId.toString();return function(){return d.select(".root"+t)}}.bind(this)();for(var n=function(r){var n=s.levels.levelsNo;o.drawingContext().selectAll(".levels").data(o.axisParameters).enter().append("svg:line").attr("x1",function(t,e){var i=t.maxValue/n*(r+1);return t.projectValueOnAxis(i).x}).attr("y1",function(t,e){var i=t.maxValue/n*(r+1);return t.projectValueOnAxis(i).y}).attr("x2",function(t,e){var i=e+1===o.axisParameters.length?0:e+1,a=o.axisParameters[i],s=a.maxValue/n*(r+1);return a.projectValueOnAxis(s).x}).attr("y2",function(t,e){var i=e+1===o.axisParameters.length?0:e+1,a=o.axisParameters[i],s=a.maxValue/n*(r+1);return a.projectValueOnAxis(s).y}).attr("class","line").style("stroke","grey").style("stroke-opacity","0.75").style("stroke-width","0.3px")},l=0;l<s.levels.levelsNo-1;l++)n(l);var c=d.format(".2%"),h=s.axis.ticks;s.axis.scaleTextWithSize&&!s.axis.tickScale&&(s.axis.tickScale=d.scaleLinear().domain([100,1200]).range([5,20])),s.axis.scaleTextWithSize&&!s.axis.axisTitleScale&&(s.axis.axisTitleScale=d.scaleLinear().domain([100,1200]).range([5,23]));var u=function(i){var a=s.levels.levelsNo;o.drawingContext().selectAll(".levels").data(o.axisParameters).enter().append("svg:text").attr("x",function(t){var e=t.maxValue/a*(i+1);return t.projectValueOnAxis(e).x}).attr("y",function(t){var e=t.maxValue/a*(i+1);return t.projectValueOnAxis(e).y}).attr("class","legend").style("font-family",h["font-family"]).style("font-size",function(){return s.axis.scaleTextWithSize?s.axis.tickScale(r)+"px":h.fontSize+"px"}).style("opacity",0).attr("fill",h.fill).text(function(t){return c(t.maxValue/a*(i+1)/t.maxValue)}).each(function(t){t.axisTickTextElements.push(this)})};for(l=0;l<s.levels.levelsNo;l++)u(l);this.axisG=this.drawingContext().selectAll(".axis").data(this.axisParameters).enter().append("g"),this.axisLines=this.axisG.attr("class","axis").append("line").attr("x1",function(t){return t.x1}).attr("y1",function(t){return t.y1}).attr("x2",function(t){return t.x2}).attr("y2",function(t){return t.y2}).attr("class","line").attr("pointer-events","none").style("stroke","grey").style("stroke-opacity",.75).style("stroke-width","0.3px"),this.rects=this.axisG.append("rect").attr("class","overlay").attr("x",function(t){return t.x1}).attr("y",function(t){return t.y1}).attr("transform",function(t,e){return"rotate("+t.angleFromNorth+","+t.x1+","+t.y1+")"}).attr("width",function(t){return t.axisLength}).attr("height",10).attr("fill-opacity",0).on("mouseover",function(t){return t.onRectMouseOver()}).on("mouseout",function(t){return t.onRectMouseOut()}).each(function(t){t.axisRect=this});var p=this.opts.axis.axisLabelProps;s.axis.textOverflow?this.axisText=this.axisG.append("text").attr("class","axis-label").attr("pointer-events","none").text("").each(function(t){for(var e=t.lines,i=0;i<e.length;i++)d.select(this).append("tspan").attr("x",function(t){return t.labelX}).attr("y",function(t){return t.labelY}).attr("dy",i*t.textLineSpacingPx).text(e[i]).style("font-family",p["font-family"]).style("font-size",function(){return s.axis.scaleTextWithSize?s.axis.axisTitleScale(r)+"px":h.fontSize+"px"}).style("fill",p.fill).attr("text-anchor","middle").each(function(t){t.labelLines.push(this)})}):this.axisText=this.axisG.append("text").attr("class","axis-label").text(function(t){return t.label}).style("font-family",p["font-family"]).style("font-size",function(){return s.axis.scaleTextWithSize?s.axis.axisTitleScale(r)+"px":h.fontSize+"px"}).style("fill",p.fill).attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(){return"translate(0, -10)"}).attr("x",function(t){return t.labelX}).attr("y",function(t){return t.labelY}).attr("pointer-events","none")}},{key:"renderArea",value:function(){var i=this;this.areas=this.data.map(function(t,e){return new x({axisMap:i.axisMap,series:t,drawingContext:i.drawingContext,seriesIdent:""+e+i.rootElId,seriesIndex:e,areaOptions:i.opts.area,onAreaUpdate:i.onUpdateArea.bind(i),zoomProps:i.opts.zoomProps})}),this.areas.forEach(function(t){return t.render()})}},{key:"renderLegend",value:function(){var t=this.opts.dims,e=t.width,i=t.height,a=t.legendW,s=this.opts.legend,r=this.rootSvg.append("svg").attr("width",e).attr("height",i);s.scaleTextWithSize&&!s.titleScale&&(s.titleScale=d.scaleLinear().domain([100,1200]).range([5,20])),s.scaleTextWithSize&&!s.labelScale&&(s.labelScale=d.scaleLinear().domain([100,1200]).range([5,15])),r.append("text").attr("class","title").attr("x",e-a*(1+s.legendWOverlap)).attr("y",s.legendTopOffset).text(s.title).style("font-size",function(){return s.scaleTextWithSize?s.titleScale(e)+"px":s.titleProperties.fontSize+"px"}).attr("fill",s.titleProperties.fill);var n=r.append("g").attr("class","legend").attr("height",s.height).attr("width",s.width).attr("transform","translate(0,"+2*s.legendTopOffset+")");n.selectAll("rect").data(this.areas).enter().append("rect").attr("x",e-a*(1+s.legendWOverlap)).attr("y",function(t,e){return e*s.iconSpacing}).attr("width",s.iconWidth).attr("height",s.iconHeight).attr("opacity",.7).on("mouseover",function(t,e){d.select(this).attr("opacity",1),d.select(t.legendLabel).attr("fill",s.colorScale(e)),t.onLegendOver(t)}).on("mouseout",function(t,e){d.select(this).attr("opacity",.7),d.select(t.legendLabel).attr("fill",s.labelTextProperties.fill),t.onLegendOut(t)}).style("fill",function(t,e){return s.colorScale(e)}).each(function(t){t.legendRect=this}),n.selectAll("text").data(this.areas).enter().append("text").attr("x",e-a*(1+s.legendWOverlap)*s.textOffsetP).attr("y",function(t,e){return e*s.iconSpacing+s.textYOffset}).style("font-size",function(){return s.scaleTextWithSize?s.labelScale(e)+"px":s.labelTextProperties.fontSize+"px"}).attr("fill",s.labelTextProperties.fill).text(function(t){return t.label}).on("mouseover",function(t,e){d.select(this).attr("fill",s.colorScale(e)),t.onLegendOver(t)}).on("mouseout",function(t,e){d.select(this).attr("fill",s.labelTextProperties.fill),t.onLegendOut(t)}).each(function(t){t.legendLabel=this})}},{key:"reRenderWithNewData",value:function(t){this.data=t,this.removeAreas(),this.renderArea()}},{key:"reRenderWithNewOptions",value:function(t){this.delete(),this.setOps(t),this.areas=[],this.render()}},{key:"removeAxis",value:function(){this.axisLines.remove(),this.axisText.remove(),this.rects.each(function(t){d.select(t.axisRect).on("mouseover",null).on("mouseout",null).remove()})}},{key:"removeAreas",value:function(){this.areas.forEach(function(t){return t.remove()})}},{key:"delete",value:function(){this.removeAreas(),this.removeAxis(),this.rootSvg.remove()}},{key:"onUpdateArea",value:function(){this.removeAreas(),this.areas.forEach(function(t){return t.render()})}}]),e}()});
