!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("d3"),require("lodash")):"function"==typeof define&&define.amd?define(["d3","lodash"],t):e.RadarChart=t(e.d3,e._)}(this,function(me,S){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function e(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var t,r,a,n,o,L="DRAGGING",T="DRAGGING_END",b="CIRCLE_LEAVE_WHILE_DRAGGING",O="CIRCLE_HOVER",P="NEUTRAL",C="CIRCLE_WHEEL_SCROLL",E="CIRCLE_ENTER",R="CIRCLE_LEAVE",I="DRAGGING_START",F="DRAGGING",w="DRAGGING_END",l="QUAD_1",c="QUAD_2",u="QUAD_3",d="QUAD_4",k=(t=!!window.opr&&!!window.opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),r="undefined"!=typeof InstallTrigger,a=!!document.documentMode,n=!a&&!!window.StyleMedia,o=!!window.chrome&&!!window.chrome.webstore,{isOpera:t,isFirefox:r,isIE:a,isEdge:n,isChrome:o,isBlink:(o||t)&&!!window.CSS}),ye=2*Math.PI,_e=l,Ae=c,ve=u,Se=d;var h=function(e,t){var r=e.axisScaleProps,i=e.zoomProps,s=e.width,a=e.axisIndex,n=e.axisOptions,o=e.innerW,l=e.innerH,c=e.optsLeftChartOffset,u=e.optsTopChartOffset,d=e.maxAxisNo,h=e.maxZoomFont,p=e.maxValue,f=e.textOverflowWidthLimit,g=e.textOverflowWidthLimitZoomed,x=e.useGlobalMax,m=c+o/2,y=u+l/2,_=c+o/2*(1-Math.sin(a*ye/d)),A=u+l/2*(1-Math.cos(a*ye/d)),v=null;_<m&&A<=y?v=_e:m<=_&&A<=y?v=Ae:_<=m&&y<=A?v=ve:m<=_&&y<=A&&(v=Se);var S=_,L=A,T=Math.abs(_-m)<1e-9?1/0:(A-y)/(_-m),b=T===1/0?0:A-T*_,O=x?p:n.axisValueMax,P=x||isNaN(n.axisValueMin)?0:n.axisValueMin,C=O-P,E=Math.sqrt(Math.pow(_-m,2)+Math.pow(A-y,2)),R=180/Math.PI*(1-a*ye/d)-180/Math.PI-90-180/Math.PI*10/E/2,I=n.axisId,F=n.label?n.label:n.axisId,w=F.split(" "),k=[w[0]];k=w.slice(1).reduce(function(e,t){return e[e.length-1].length+t.length<=f?e[e.length-1]=e[e.length-1]+" "+t:e.push(t),e},k);var V=[w[0]];V=w.slice(1).reduce(function(e,t){return e[e.length-1].length+t.length<=g?e[e.length-1]=e[e.length-1]+" "+t:e.push(t),e},V);var z,N,D,W,H,j,M,G,Z,Q,B,Y,q,U,X,J,K,$,ee,te,re,ie,se,ae,ne,oe,le=Math.sin(a*ye/d),ce=Math.cos(a*ye/d),ue=function(e){return{x:c+o/2*(1-(parseFloat(e)-P)/C*le),y:u+l/2*(1-(parseFloat(e)-P)/C*ce)}},de=i.scaleExtent,he=de.maxZoom,pe=de.minZoom,fe=me.scaleLog().base(20).domain([pe,he]).range([O,P]),ge=(N=(z={axisScaleProps:r,axisLabelCordLop:fe,lines:k,projectValueOnAxis:ue,textOverflowWidthLimit:f,width:s,zoomProps:i}).axisScaleProps,D=z.axisLabelCordLop,W=z.lines,H=z.projectValueOnAxis,j=z.textOverflowWidthLimit,M=z.width,G=z.zoomProps,Z=me.scaleLinear().domain([100,1200]).range([5,20]),Q=me.scaleLinear().domain([100,1200]).range([N.minTitleSize,N.maxTitleSize]),B=me.scaleLinear().domain([100,1200]).range([N.minTextLineSpacing,N.maxTextLineSpacing]),Y=function(e){return H(D(e||G.scaleExtent.minZoom))},q=Z(M),U=Q(M),X=Z(M),J=Q(M)*j,K=function(){return(1+W.length)*Q(M)*2},{tickScale:Z,axisTitleScale:Q,textLineSpacingPx:B,axisLabelCords:Y,scaledTickSize:q,scaledTitleSize:U,currentTickSize:X,overLayWidth:J,overLayx:function(){return Y().x-J/2},overLayHeight:K,overLayy:function(){return Y().y-K()/2.5}}),xe=(ee=($={zoomProps:i,width:s,scaledTitleSize:ge.scaledTitleSize,scaledTickSize:ge.scaledTickSize,maxValue:O,minValue:P,maxZoomFont:h,textLineSpacingPx:ge.textLineSpacingPx}).zoomProps.scaleExtent,te=ee.maxZoom,re=ee.minZoom,ie=$.width,se=$.scaledTitleSize,ae=$.scaledTickSize,ne=$.maxZoomFont,oe=$.textLineSpacingPx,{axisTitleSizeLop:me.scaleLog().base(5).domain([re,te]).range([se,.1*se]),axisTitleSizeLopMin:me.scaleLog().base(5).domain([re,te]).range([3,2]),tickFontLop:me.scaleLog().domain([re,te]).range([ae,ne]),axisLabelFactorLop:me.scaleLog().domain([re,te]).range([.2,.1]),labelLineSpacingLop:me.scaleLinear().domain([re,te]).range([oe(ie),.1*oe(ie)]),labelLineSpaceLopMin:me.scaleLinear().domain([re,te]).range([.5*oe(ie),.3*oe(ie)*.5])});return Object.assign({axisLabelRotation:function(){return-270<R?R-180:R},x1:m,y1:y,x2:_,y2:A,quad:v,labelX:S,labelY:L,gradient:T,maxValue:O,minValue:P,range:C,axisLength:E,angleFromNorth:R,axisId:I,label:F,words:w,lines:k,zoomLines:V,projectCordToAxis:function(e,t){return T===1/0?{x:m,y:t}:T<-2||0<=T||T<.145?{x:e,y:T*e+b}:{x:(t-b)/T,y:t}},projectValueOnAxis:ue,cordOnAxisToValue:function(e,t){if(T===1/0){var r=Math.abs(A-t);return P+(E-r)*C/E}if(0<=T&&T<1e-8){var i=Math.abs(_-e);return P+(E-i)*C/E}return P+C/le*(2*(e-c)/o-1)*-1},axisLabelCordLop:fe},ge,xe)},p=Object.freeze({setRootElements:function(e){this.__STATE__.components.root.rootSvg=e.rootSvg,this.__STATE__.components.root.rootG=e.rootG,this.__STATE__.components.root.legendSvg=e.legendSvg,this.__STATE__.components.root.legendG=e.legendG},setAxisPerecentLevelForAxis:function(e,t){this.__STATE__.components.axis[e].percLabels.push(t)},setAxisLineElForAxis:function(e,t){this.__STATE__.components.axis[e].axisLine=t},setAxisOverlayRectForAxis:function(e,t){this.__STATE__.components.axis[e].overLayRect=t},setAxisLabelParentForAxis:function(e,t){this.__STATE__.components.axis[e].axisLabelEl=t},setLabelValueForAxis:function(e,t){this.__STATE__.components.axis[e].labelValue=t},addLabelLineForAxis:function(e,t){this.__STATE__.components.axis[e].labelLines.push(t)},addZoomedLabelLinesForAxis:function(e,t){this.__STATE__.components.axis[e].zoomedLabelLines.push(t)}}),f=Object.freeze({setAreaCircleRef:function(e,t){this.__STATE__.components.areas[e].circleRef.push(t)},setAreaCircleOverlayRef:function(e,t){this.__STATE__.components.areas[e].circleOverlayRef.push(t)},setAreaPolygonRef:function(e,t){this.__STATE__.components.areas[e].polygonRef=t},setAreaLegendRect:function(e,t){this.__STATE__.components.areas[e].legendRect=t},setAreaLegendLabelLines:function(e,t){this.__STATE__.components.areas[e].legendLabelLines.push(t)},setAreaLegendRectOverlay:function(e,t){this.__STATE__.components.areas[e].legendRectOverlay=t},updateSizesOnZoomForAllAreas:function(i){var s=this;this.getAreaDatums().map(function(e){return e.props.seriesId}).forEach(function(e){var t=s.__STATE__.opts.area,r=s.areaForAreaId(e);t.lineProps.strokeWidth=r.props.areaLineLop(i),t.circleProps.defaultRadius=r.props.circleRadiusLop(i),t.labelProps.fontSize=r.props.fontLop(i)})}}),g=Object.assign({},p,f),x=Object.freeze({areaRenderProps:function(){return{areaHighlightProps:this.__STATE__.opts.area.areaHighlightProps,circleProps:this.__STATE__.opts.area.circleProps,hoverCircleOpacity:this.__STATE__.opts.area.hoverCircleOpacity,defaultCircleOpacity:this.__STATE__.opts.area.defaultCircleOpacity,lineProps:this.__STATE__.opts.area.lineProps,labelProps:this.__STATE__.opts.area.labelProps}},axisRenderProps:function(){return{width:this.calculatedDims.width,levels:this.__STATE__.opts.levels,ticksAttr:this.__STATE__.opts.axis.ticks,lineProps:this.__STATE__.opts.axis.lineProps,axisLabelProps:this.__STATE__.opts.axis.axisLabelProps,rotateTextWithAxis:this.__STATE__.opts.axis.rotateTextWithAxis,wheelLabelAreaId:this.__STATE__.opts.axis.wheelLabelAreaId}},renderInitProps:function(){var e=this.calculatedDims;return{width:e.width,height:e.height,paddingH:e.paddingH,paddingW:e.paddingW,legendW:e.legendW,legendDims:e.legendDims,legendOpts:this.__STATE__.opts.legend,backgroundColor:this.__STATE__.opts}},renderConstructProps:function(){return{chartRootName:this.__STATE__.opts.chartRootName,stateSetters:this.stateSetters,stateQuery:this.stateQuery,selectors:this.selectors,rootElementId:this.__STATE__.opts.rootElementId,rootElPropsFn:this.rootEls,legendRenderProps:this.renderProps.legendRenderProps,areaRenderProps:this.renderProps.areaRenderProps}},legendRenderProps:function(){return{height:this.calculatedDims.height,width:this.calculatedDims.width,legendW:this.calculatedDims.legendW,legendOpts:this.__STATE__.opts.legend,legendDims:this.legendDims,getAreaDatums:this.getAreaDatums.bind(this)}},rootEls:function(){return this.__STATE__.components.root}}),m=Object.freeze({axisIds:function(){return this.getAxisDatums().map(function(e){return e.axisId})},areaPoint:function(e,t){return this.__STATE__.components.areas[e].state.points.find(function(e){return e.axisId===t})},areaForAreaId:function(e){return this.__STATE__.components.areas[e]},areaProps:function(){return this.__STATE__.opts.area},currentValueFor:function(e,t){return this.__STATE__.components.areas[e].state.points.find(function(e){return e.axisId===t}).value},isDragActiveForArea:function(e){return this.__STATE__.components.areas[e].state.dragActive},onWheelAxisFn:function(){return this.__STATE__.opts.axis.onWheelAxis},onAxisLabelOutFn:function(){return this.__STATE__.opts.axis.onAxisLabelOut},onAxisLabelOverFn:function(){return this.__STATE__.opts.axis.onAxisLabelOverFn},legendProps:function(){return this.__STATE__.opts.legend},wheelLabelAreaId:function(){return this.__STATE__.opts.axis.wheelLabelAreaId},zoomEnabled:function(){return this.__STATE__.opts.enableZoom},zoomProps:function(){return this.__STATE__.opts.zoomProps}}),y=Object.freeze({polygonClassName:function(e){return"".concat(this.polygonClassForSeriesName(e)," ").concat(this.polygonDefaultName())},polygonClassForSeriesName:function(e){return"".concat(this.chartRootName,"chart-poly-").concat(e)},polygonDefaultName:function(){return"".concat(this.chartRootName,"-polygon")},polygonVertextClassNames:function(e){return"".concat(this.polygonVertexDefault()," ").concat(this.polygonVertexClassForSeries(e))},polygonVertexDefault:function(){return"".concat(this.chartRootName,"poly-vertex")},polygonVertexClassForSeries:function(e){return"".concat(this.chartRootName,"poly-vertex").concat(e)},labelValueForAxis:function(e){return me.select(this.axisById(e).labelValue)},selectPolyVertexLabelForSeries:function(e){return this.drawingContext().selectAll("."+this.polygonVertexClassForSeries(e))},circleOverlayClassName:function(e){return"".concat(this.circleOverlayDefaultName()," ").concat(this.circleOverlayForSeriesName(e))},circleOverlayForSeriesName:function(e){return"".concat(this.chartRootName,"circle-overlay-").concat(e)},circleOverlayDefaultName:function(){return"".concat(this.chartRootName,"circle-overlay")},circleClassName:function(e){return"".concat(this.circleClassDefaultName()," ").concat(this.circleClassForSeriesName(e))},circleClassForSeriesName:function(e){return"".concat(this.chartRootName,"poly-circle-").concat(e)},circleClassDefaultName:function(){return"".concat(this.chartRootName,"circle-class")},rootIdent:function(){var e="radarchartroot".concat(this.chartRootName);return{aStr:e,fSel:"."+e}},drawingContext:function(){return this.__STATE__.components.root.rootSvg.select(this.rootIdent().fSel)},selectAllPolygons:function(){return this.drawingContext().selectAll("."+this.polygonDefaultName())},selectPolygonForSeries:function(e){return this.drawingContext().select("."+this.polygonClassForSeriesName(e))},selectAllCircles:function(){return this.drawingContext().selectAll("."+this.circleClassDefaultName())},selectAllCirclesForSeries:function(e){return this.drawingContext().selectAll("."+this.circleClassForSeriesName(e))},selectAllCircleOverlaysForSeries:function(e){return this.drawingContext().selectAll("."+this.circleOverlayForSeriesName(e))},selectAllCircleOverlays:function(){return this.drawingContext().selectAll("."+this.circleOverlayDefaultName())},selectRootSvg:function(){return this.__STATE__.components.root.rootSvg},selectLegendSvg:function(){return this.__STATE__.components.root.rootSvg.select("."+this.legendSvgId())},selectLegendG:function(){return this.__STATE__.components.root.rootSvg.select("."+this.legendGId())},legendRectDefaultName:function(){return"".concat(this.chartRootName,"-legend-rect")},legendRectNameForSeries:function(e){return"".concat(e,"-legend-rect")},legendRectClassName:function(e){return"".concat(this.legendRectDefaultName()," ").concat(this.legendRectNameForSeries(e))},legendSvgId:function(){return"".concat(this.chartRootName,"-legend-svg")},legendGId:function(){return"".concat(this.chartRootName,"-legend-g")},legendRectOverlayDefault:function(e){return"".concat(this.chartRootName,"-legend-rect-overlay")},legendRectOverlaySeries:function(e){return"legend-rect-overlay-".concat(e)},legendRectOverlayClassName:function(e){return"".concat(this.legendRectOverlayDefault()," ").concat(this.legendRectOverlaySeries(e))},selectLegendOverlaysForSeries:function(e){return this.__STATE__.components.root.rootSvg.select("."+this.legendRectOverlaySeries(e))},axisTextOverlayClassName:function(e){return"".concat(this.chartRootName,"-axis-text-overlay-").concat(e)},selectAxisTextForAxis:function(e){return this.__STATE__.components.root.rootSvg.select("."+this.axisTextOverlayClassName(e))},selectAxisTicksForAxis:function(e){var t=this.axisById(e);return me.selectAll(t.percLabels)},selectRootG:function(){return this.__STATE__.components.root.rootG}}),_=function(){function t(e){var r=this;s(this,t),this.__STATE__=S.merge({opts:{enableZoom:!0,backgroundColor:"white",zoomProps:{scaleExtent:{minZoom:1,maxZoom:12}},data:[],dims:{width:500,height:500,translateXp:.05,translateYp:.05,legendSpaceP:.1,innerPaddingP:.1},legend:{interactive:!0,legendWidthP:.9,legendHeightP:.2,legendWOverlap:1.1,legendTopOffsetP:.03,textYOffset:9,textOffsetP:.75,iconHeightP:.02,iconWidthP:.02,iconSpacingP:.05,title:"Test title",scaleTextWithSize:!0,titleScale:null,labelScale:null,titleProperties:{fontSize:12,fontScaleMin:5,fontScaleMax:20,"font-family":"sans-serif",fill:"#404040"},labelTextProperties:{fontSize:11,fontScaleMin:5,fontScaleMax:20,"font-family":"sans-serif",fill:"#737373"}},levels:{levelsFractions:[.25,.5,.75]},showLegend:!0,axis:{config:[],useGlobalMax:!1,maxValue:.6,leftOffsetPLabel:.85,rotateTextWithAxis:!0,textOverflowWidthLimit:10,textOverflowWidthLimitZoomed:50,textLineSpacingPx:10,tickScale:null,axisTitleScale:null,axisScaleProps:{minTitleSize:5,maxTitleSize:20,minTickSize:5,maxTickSize:20,minTextLineSpacing:1,maxTextLineSpacing:20},axisLabelProps:{"font-family":"sans-serif",fontSize:11,fill:"#808080","value-fill":"#548bd8","hover-fill":"#E44822"},lineProps:{fill:"#E0E0E0","hover-fill":"#E44822"},ticks:{fill:"#737373",minZoomFont:10,maxZoomFont:1,"font-family":"sans-serif"},wheelLabelAreaId:null,onAxisLabelOver:null,onAxisLabelOut:null,onWheelAxis:null},area:{areaHighlight:!1,areaHighlightProps:{defaultAreaOpacity:0,highlightedAreaOpacity:.7,hiddenAreaOpacity:.1,defaultStrokeOpacity:.8,highlightedStrokeOpacity:1,hiddenStrokeOpacity:.2,defaultLabelOpacity:0,highlightedLabelOpacity:1,hiddenLabelOpacity:0},labelProps:{"font-family":"sans-serif",fontSize:8,maxFontSize:2},defaultCircleOpacity:.3,hoverCircleOpacity:.5,circleProps:{defaultRadius:5,maxZoomRadius:1,circleOverlayRadiusMult:1.5},useColorScale:!0,areaColorScale:me.scaleOrdinal(me.schemeAccent),lineColorScale:me.scaleOrdinal(me.schemeAccent),onValueChange:null,onValueFinishChange:null,textOverflowWidthLimit:10,textLineSpacingRangeLegend:[1,20],lineProps:{strokeWidth:2,maxZoomStroke:.5}}}},{opts:e},{calculatedDims:{},series:[],axisConfig:[],components:{root:{rootSvg:null,rootG:null},areas:{},axis:{}}}),S.each(g,function(e,t){r[t]=r[t].bind(r)}),S.each(x,function(e,t){r[t]=r[t].bind(r)}),S.each(m,function(e,t){r[t]=r[t].bind(r)}),S.each(y,function(e,t){r[t]=r[t].bind(r)}),this.__construct()}return e(t,[{key:"__construct",value:function(){this.__calculateDimensions(),this.__associateData(),this.__buildAxis(),this.__buildArea(),this.__buildLegend()}},{key:"__calculateDimensions",value:function(){this.__STATE__.calculatedDims=S.merge({},this.__STATE__.opts.dims,{legendDims:S.pick(this.__STATE__.opts.legend,["legendWidthP","legendHeightP","iconSpacingP","iconWidthP","iconHeightP"])});var e=this.__STATE__.calculatedDims;e.paddingW=e.width*e.translateXp/2,e.paddingH=e.paddingW,e.legendW=e.width*e.legendSpaceP,e.chartContainerW=e.width-e.paddingW-e.legendW,e.chartContainerH=e.height-2*e.paddingH,e.innerPadding=e.chartContainerH*e.innerPaddingP,e.innerW=e.chartContainerW-2*e.innerPadding,e.innerH=e.chartContainerH-2*e.innerPadding,e.optsLeftChartOffset=e.innerPadding,e.optsTopChartOffset=e.innerPadding;var t=this.legendDims;t.width=e.legendW*t.legendWidthP,t.height=e.height*t.legendHeightP,t.iconSpacing=t.iconSpacingP*e.height,t.iconHeight=t.iconHeightP*e.height,t.iconWidth=t.iconWidthP*e.height}},{key:"__associateData",value:function(){this.__STATE__.series=this.__STATE__.opts.data,this.__STATE__.axisConfig=this.__STATE__.opts.axis.config,this.__STATE__.calculatedDims.maxAxisNo=this.__STATE__.axisConfig.length}},{key:"__buildAxis",value:function(){var s=this,e=this.axisConfig.map(function(e,t){var r=s.__STATE__.opts.axis,i={axisScaleProps:s.__STATE__.opts.axis.axisScaleProps,zoomProps:s.__STATE__.opts.zoomProps,width:s.calculatedDims.width,innerW:s.calculatedDims.innerW,innerH:s.calculatedDims.innerH,optsLeftChartOffset:s.calculatedDims.optsLeftChartOffset,optsTopChartOffset:s.calculatedDims.optsLeftChartOffset,useGlobalMax:r.useGlobalMax,maxValue:r.maxValue,maxAxisNo:s.calculatedDims.maxAxisNo,maxZoomFont:s.__STATE__.opts.axis.ticks.maxZoomFont,textOverflowWidthLimit:r.textOverflowWidthLimit,textOverflowWidthLimitZoomed:r.textOverflowWidthLimitZoomed,axisIndex:t,axisOptions:Object.assign({},e)};return h(i)});this.__STATE__.components.axis=S.reduce(e,function(e,t){return e[t.axisId]={props:t,state:{},labelLines:[],zoomedLabelLines:[],percLabels:[]},e},{})}},{key:"__buildArea",value:function(){var T=this,e=this.__STATE__.series.map(function(e,t){var r,i,s,a,n,o,l,c,u,d,h,p,f,g,x,m,y,_,A,v,S=T.__STATE__.opts.area,L={series:e,seriesInx:t,textOverflowWidthLimit:S.textOverflowWidthLimit,areaOptions:S,axisComponents:T.__STATE__.components.axis,zoomProps:T.__STATE__.opts.zoomProps,lineProps:S.lineProps,circleProps:S.circleProps,labelProps:S.labelProps};return i=(r=L).series,s=r.seriesInx,a=r.textOverflowWidthLimit,n=r.areaOptions,o=r.axisComponents,l=r.zoomProps,c=r.lineProps,u=r.circleProps,d=r.labelProps,h=i.seriesId,p=i.fill?i.fill:n.areaColorScale(s),f=i.data.map(function(e){return{seriesId:h,cords:o[e.axis].props.projectValueOnAxis(e.value),value:e.value,axisId:e.axis}}),g=f.reduce(function(e,t){return e+t.cords.x+","+t.cords.y+" "},""),x=l.scaleExtent.maxZoom,m=me.scaleLog().base(8).domain([1,x]).range([c.strokeWidth,c.maxZoomStroke]),y=me.scaleLog().base(8).domain([1,x]).range([u.defaultRadius,u.maxZoomRadius]),_=me.scaleLog().domain([1,x]).range([d.fontSize,d.maxFontSize]),A=i.label.split(" "),v=[A[0]],v=A.slice(1).reduce(function(e,t){return e[e.length-1].length+t.length<=a?e[e.length-1]=e[e.length-1]+" "+t:e.push(t),e},v),{props:{series:i,seriesId:h,seriesInx:s,fillColor:p,areaLineLop:m,circleRadiusLop:y,fontLop:_,legendLabelLines:v},state:{points:f,svgStringRep:g,currentAreaOpacity:n.areaHighlightProps.defaultAreaOpacity,state:P}}});this.__STATE__.components.areas=S.reduce(e,function(e,t){return e[t.props.seriesId]={props:t.props,state:t.state,circleRef:[],circleOverlayRef:[],legendLabelLines:[]},e},{})}},{key:"__buildLegend",value:function(){var e=this.__STATE__.opts.legend,t=e.titleProperties,r=e.labelTextProperties;e.scaleTextWithSize&&!e.titleScale&&(e.titleScale=me.scaleLinear().domain([100,1200]).range([t.fontScaleMin,t.fontScaleMax])),e.scaleTextWithSize&&!e.labelScale&&(e.labelScale=me.scaleLinear().domain([100,1200]).range([r.fontScaleMin,r.fontScaleMax])),e.labelTextLineSpacing=me.scaleLinear().domain([100,1200]).range(this.areaProps().textLineSpacingRangeLegend)}},{key:"axisById",value:function(e){return this.__STATE__.components.axis[e]}},{key:"seriesById",value:function(e){return this.__STATE__.components.areas[e]}},{key:"getAxisDatums",value:function(){return S.values(this.__STATE__.components.axis).map(function(e){return e.props})}},{key:"getAreaDatums",value:function(){return S.values(this.__STATE__.components.areas).map(function(e){return{props:e.props,state:e.state}})}},{key:"stateSetters",get:function(){var r=this;return S.keys(g).reduce(function(e,t){return e[t]=r[t],e},{})}},{key:"stateQuery",get:function(){var r=this;return S.keys(m).reduce(function(e,t){return e[t]=r[t],e},{})}},{key:"selectors",get:function(){var r=this;return S.keys(y).reduce(function(e,t){return e[t]=r[t],e},{})}},{key:"opts",get:function(){return this.__STATE__.opts}},{key:"calculatedDims",get:function(){return this.__STATE__.calculatedDims}},{key:"legendDims",get:function(){return this.calculatedDims.legendDims}},{key:"renderProps",get:function(){var r=this;return S.keys(x).reduce(function(e,t){return e[t]=r[t],e},{})}},{key:"axisConfig",get:function(){return this.__STATE__.axisConfig}},{key:"chartRootName",get:function(){return this.__STATE__.opts.chartRootName}},{key:"axisProps",get:function(){return this.__STATE__.opts.axis}}]),t}();Object.assign(_.prototype,g),Object.assign(_.prototype,x),Object.assign(_.prototype,m),Object.assign(_.prototype,y);var A=function(){function i(e){var t=this;for(var r in s(this,i),e)this[r]=e[r];this.drawingContext=this.selectors.drawingContext,this.circularSegmentClass=function(e){return"".concat(t.chartRootName).concat(e.axisId,"csegline")},this.axisOverlayRectClassName=function(e){return"".concat(t.chartRootName).concat(e.axisId,"axisoverlayrect")},this.axisLabelParentClassName=function(e){return"".concat(t.chartRootName).concat(e.axisId,"axislabelparent")}}return e(i,[{key:"render",value:function(e,o){for(var t=this,n=e.width,s=e.levels,r=e.lineProps,a=e.ticksAttr,l=e.axisLabelProps,i=e.rotateTextWithAxis,c=e.wheelLabelAreaId,u=this.eventHandlerFactory.createAreaEventHandler,d=function(a){var n=s.levelsFractions;t.drawingContext().selectAll(".levels").data(o).enter().append("svg:line").attr("x1",function(e,t){var r=e.range*n[a]+e.minValue;return e.projectValueOnAxis(r).x}).attr("y1",function(e,t){var r=e.range*n[a]+e.minValue;return e.projectValueOnAxis(r).y}).attr("x2",function(e,t){var r=t+1===o.length?0:t+1,i=o[r],s=i.range*n[a]+i.minValue;return i.projectValueOnAxis(s).x}).attr("y2",function(e,t){var r=t+1===o.length?0:t+1,i=o[r],s=i.range*n[a]+i.minValue;return i.projectValueOnAxis(s).y}).attr("class",function(e){return t.circularSegmentClass(e)}).style("stroke","#DCDCDC").style("stroke-opacity","0.75").style("stroke-width","0.3px")},h=0;h<s.levelsFractions.length;h++)d(h);var p=me.format(".2%"),f=this.stateSetters.setAxisPerecentLevelForAxis,g=function(r){var i=s.levelsFractions;t.drawingContext().selectAll(".levels").data(o).enter().append("svg:text").attr("x",function(e){var t=e.range*i[r]+e.minValue;return e.projectValueOnAxis(t).x}).attr("y",function(e){var t=e.range*i[r]+e.minValue;return e.projectValueOnAxis(t).y}).attr("class","legend").style("font-family",a["font-family"]).style("font-size",function(e){return e.scaledTickSize+"px"}).style("opacity",0).attr("fill",a.fill).text(function(e){return p(i[r])}).each(function(e){f(e.axisId,this)})};for(h=0;h<s.levelsFractions.length;h++)g(h);var x=this.drawingContext().selectAll(".axis").data(o).enter().append("g"),m=this.stateSetters.setAxisLineElForAxis;x.append("line").attr("class","axisline").attr("x1",function(e){return e.x1}).attr("y1",function(e){return e.y1}).attr("x2",function(e){return e.x2}).attr("y2",function(e){return e.y2}).attr("pointer-events","none").style("stroke",r.fill).style("stroke-opacity",.75).style("stroke-width","0.3px").each(function(e){m(e.axisId,this)});var y=this.stateSetters.setAxisOverlayRectForAxis;x.append("rect").attr("class",function(e){return t.axisOverlayRectClassName(e)}).attr("x",function(e){return e.x1}).attr("y",function(e){return e.y1}).attr("transform",function(e,t){return"rotate("+e.angleFromNorth+","+e.x1+","+e.y1+")"}).attr("width",function(e){return e.axisLength}).attr("height",10).attr("fill-opacity",0).each(function(e){y(e.axisId,this)});var _=this.stateSetters,A=_.addLabelLineForAxis,v=_.addZoomedLabelLinesForAxis,S=_.setAxisLabelParentForAxis,L=_.setLabelValueForAxis;x.append("text").attr("class",function(e){return t.axisLabelParentClassName(e)}).attr("pointer-events","none").attr("transform",function(e,t){return i?"rotate("+e.axisLabelRotation()+","+e.x2+","+e.y2+")":""}).text("").each(function(e){var r=this;S(e.axisId,this);for(var i=e.lines,t=function(t){me.select(r).append("tspan").attr("x",function(e){return e.axisLabelCords().x}).attr("y",function(e){return e.axisLabelCords().y}).attr("dy",function(e){return e.textLineSpacingPx(n)*t}).text(i[t]).style("font-family",l["font-family"]).style("font-size",function(e){return e.axisTitleScale(n)+"px"}).style("fill",l.fill).attr("text-anchor","middle").each(function(e){A(e.axisId,this)})},s=0;s<i.length;s++)t(s);me.select(this).append("tspan").attr("x",function(e){return e.axisLabelCords().x}).attr("y",function(e){return e.axisLabelCords().y}).attr("dy",function(e){return e.textLineSpacingPx(n)*e.lines.length}).text("").style("font-family",l["font-family"]).style("font-size",function(e){return e.axisTitleScale(n)+"px"}).style("fill",l["value-fill"]).attr("text-anchor","middle").each(function(e){L(e.axisId,this)});var a=function(t){me.select(r).append("tspan").attr("x",function(e){return e.axisLabelCords().x}).attr("y",function(e){return e.axisLabelCords().y}).attr("dy",function(e){return e.textLineSpacingPx(n)*t}).text(e.zoomLines[t]).style("font-family",l["font-family"]).style("font-size",function(e){return e.axisTitleScale(n)+"px"}).style("fill",l.fill).style("fill-opacity",0).attr("text-anchor","middle").each(function(e){v(e.axisId,this)})};for(s=0;s<e.zoomLines.length;s++)a(s)}),x.append("rect").attr("class",function(e){return t.selectors.axisTextOverlayClassName(e.axisId)}).attr("x",function(e){return e.overLayx()}).attr("y",function(e){return e.overLayy()}).attr("width",function(e){return e.overLayWidth}).attr("height",function(e){return e.overLayHeight()}).attr("fill-opacity",0).attr("transform",function(e,t){return i?"rotate("+e.axisLabelRotation()+","+e.x2+","+e.y2+")":""}).on("wheel",function(){if(c)return u(C,c)}()).on("mouseover",this.eventHandlerFactory.onAxisLabelOver()).on("mouseout",this.eventHandlerFactory.onAxisLabelOut())}},{key:"removeAxis",value:function(e){var t=this;e.forEach(function(e){t.selectors.selectAxisTextForAxis(e).on("wheel",null).on("mouseover",null).on("mouseout",null)})}}]),i}(),v=function(){function r(e){for(var t in s(this,r),e)this[t]=e[t];this.drawingContext=this.selectors.drawingContext}return e(r,[{key:"render",value:function(e,t){var r=this,i=this.areaRenderProps(),s=i.areaHighlightProps,a=i.circleProps,n=i.lineProps,o=i.labelProps,l=i.hoverCircleOpacity,c=i.defaultCircleOpacity,u=me.format(".2"),d=this.stateSetters,h=d.setAreaCircleRef,p=d.setAreaCircleOverlayRef,f=d.setAreaPolygonRef,g=this.eventHandlerFactory.createAreaEventHandler;this.drawingContext().selectAll(this.selectors.polygonDefaultName()).data(t).enter().append("polygon").attr("class",function(e){return r.selectors.polygonClassName(e.props.seriesId)}).style("stroke-width",n.strokeWidth+"px").style("stroke",function(e){return e.props.fillColor}).style("stroke-opacity",s.defaultStrokeOpacity).attr("points",function(e){return e.state.svgStringRep}).style("fill",function(e){return e.props.fillColor}).style("fill-opacity",function(e){return e.state.currentAreaOpacity}).each(function(e){f(e.props.seriesId,this)}).each(function(t){if(r.drawingContext().selectAll(".polygon-labels").data(t.state.points).enter().append("svg:text").text(function(e){return u(e.value)}).attr("x",function(e){return e.cords.x}).attr("y",function(e){return e.cords.y}).attr("class",function(e){return r.selectors.polygonVertextClassNames(t.props.seriesId)}).style("font-family",o["font-family"]).style("font-size",o.fontSize+"px").style("opacity",function(e){return r.stateQuery.isDragActiveForArea(e.seriesId)?1:s.defaultLabelOpacity}),t.props.series.showCircle){r.drawingContext().selectAll(r.selectors.circleClassDefaultName()).data(t.state.points).enter().append("svg:circle").attr("r",function(e){return e.dragActive?a.circleOverlayRadiusMult*a.defaultRadius:a.defaultRadius}).attr("alt",function(e){return Math.max(e.value,0)}).attr("cx",function(e){return e.cords.x}).attr("cy",function(e){return e.cords.y}).attr("class",function(e){return r.selectors.circleClassName(e.seriesId)}).style("fill",t.props.fillColor).style("fill-opacity",function(e){return r.stateQuery.isDragActiveForArea(e.seriesId)?l:c}).each(function(e){h(t.props.seriesId,this),e.circleRef=this});var e=r.drawingContext().selectAll("circle-overlays").data(t.state.points).enter().append("svg:circle").attr("r",a.defaultRadius*a.circleOverlayRadiusMult).attr("cx",function(e){return e.cords.x}).attr("cy",function(e){return e.cords.y}).attr("opacity",0).attr("class",function(e){return r.selectors.circleOverlayClassName(e.seriesId)}).attr("pointer-events","all").each(function(){p(t.props.seriesId,this)});t.props.series.circleHighlight&&e.on("mouseover",g(E,t.props.seriesId)).on("mouseout",g(R,t.props.seriesId)),t.props.series.dragEnabled&&e.call(me.drag().subject(function(e){return this}).on("start",g(I,t.props.seriesId)).on("drag",g(F,t.props.seriesId)).on("end",g(w,t.props.seriesId)))}})}},{key:"removeAreaForSeries",value:function(e){this.selectors.selectPolygonForSeries(e).data([]).exit().remove(),this.selectors.selectAllCirclesForSeries(e).data([]).exit().remove(),this.selectors.selectAllCircleOverlaysForSeries(e).on("mouseover",null).on("mouseout",null).on("start",null).on("drag",null).on("end",null),this.selectors.selectAllCircleOverlaysForSeries(e).data([]).exit().remove(),this.selectors.selectPolyVertexLabelForSeries(e).data([]).exit().remove()}},{key:"removeArea",value:function(e){var t=this;e.forEach(function(e){t.removeAreaForSeries(e)})}}]),r}(),V=function(){function r(e){for(var t in s(this,r),e)this[t]=e[t];this.legendSvg=this.selectors.selectLegendSvg}return e(r,[{key:"render",value:function(){var t=this,e=this.legendRenderProps(),r=e.height,n=e.width,o=e.legendW,l=e.legendOpts,c=e.legendDims,i=(0,e.getAreaDatums)();this.legendSvg().append("text").attr("class","legend-title").attr("x",n-o*(1+l.legendWOverlap)).attr("y",l.legendTopOffsetP*r).text(l.title).style("font-size",function(){return l.scaleTextWithSize?l.titleScale(n)+"px":l.titleProperties.fontSize+"px"}).style("font-family",l.titleProperties["font-family"]).attr("fill",l.titleProperties.fill);var s=this.stateSetters,a=s.setAreaLegendRect,u=s.setAreaLegendLabelLines,d=s.setAreaLegendRectOverlay;this.selectors.selectLegendG().selectAll("legend-rect").data(i).enter().append("rect").attr("class",function(e){return t.selectors.legendRectNameForSeries(e.props.seriesId)}).attr("x",n-o*(1+l.legendWOverlap)).attr("y",function(e,t){return t*c.iconSpacing}).attr("width",c.iconWidth).attr("height",c.iconHeight).attr("opacity",.7).style("fill",function(e){return e.props.fillColor}).each(function(e){a(e.props.seriesId,this)}),this.selectors.selectLegendG().selectAll("text").data(i).enter().append("text").text("").each(function(e,r){for(var i=this,t=e.props.legendLabelLines,s=function(t){me.select(i).append("tspan").attr("x",n-o*(1+l.legendWOverlap)*l.textOffsetP).attr("y",function(e){return r*c.iconSpacing+l.textYOffset}).attr("dy",function(e){return l.labelTextLineSpacing(n)*t}).text(function(e){return e.props.legendLabelLines[t]}).style("font-size",function(){return l.scaleTextWithSize?l.labelScale(n)+"px":l.labelTextProperties.fontSize+"px"}).style("font-family",l.labelTextProperties["font-family"]).attr("fill",l.labelTextProperties.fill).attr("original-fill",l.labelTextProperties.fill).each(function(e){u(e.props.seriesId,this)})},a=0;a<t.length;a++)s(a)}),this.selectors.selectLegendG().selectAll("legend-rect-overlays").data(i).enter().append("rect").attr("class",function(e){return t.selectors.legendRectOverlayClassName(e.props.seriesId)}).attr("x",n-o*(1+l.legendWOverlap)).attr("y",function(e,t){return t*c.iconSpacing}).attr("width",o*(1+l.legendWOverlap)).attr("height",c.iconSpacing).attr("opacity",0).on("mouseover",this.eventHandlerFactory.onLegendOver()).on("mouseout",this.eventHandlerFactory.onLegendOut()).each(function(e){d(e.props.seriesId,this)})}},{key:"removeLegend",value:function(e){var t=this;e.forEach(function(e){t.selectors.selectLegendOverlaysForSeries(e).on("mouseover",null).on("mouseout",null)}),this.selectors.selectLegendSvg().remove()}}]),r}(),z=function(){function r(e){for(var t in s(this,r),e)this[t]=e[t];this.rootElement=document.getElementById(e.rootElementId),this.axisRender=new A(Object.assign({},e)),this.areaRender=new v(Object.assign({},e)),this.legendRender=new V(Object.assign({},e))}return e(r,[{key:"renderAxis",value:function(e,t){return this.axisRender.render(e,t),this}},{key:"renderArea",value:function(e,t){return this.areaRender.render(e,t),this}},{key:"renderLegend",value:function(){return this.legendRender.render(),this}},{key:"init",value:function(e){var t=e.width,r=e.height,i=e.paddingH,s=e.paddingW,a=e.backgroundColor,n=e.legendDims,o=e.legendOpts,l=me.select(this.rootElement).append("svg").style("background",a).attr("width",t).attr("height",r),c=l.append("g").attr("class",this.selectors.rootIdent().aStr).attr("transform","translate("+s+","+i+")"),u=l.append("svg").attr("class",this.selectors.legendSvgId()).attr("width",t).attr("height",r),d=u.append("g").attr("class",this.selectors.legendGId()).attr("height",n.height).attr("width",n.width).attr("transform","translate(0,"+o.legendTopOffsetP*r*2+")");if(this.stateQuery.zoomEnabled()){var h=this.stateQuery.zoomProps(),p=me.zoom();p.on("zoom",this.eventHandlerFactory.zoomHandler(p)).translateExtent([[0,0],[t,r]]).scaleExtent([h.scaleExtent.minZoom,h.scaleExtent.maxZoom]),l.call(p)}return this.stateSetters.setRootElements({rootSvg:l,rootG:c,legendSvg:u,legendG:d}),this}}]),r}(),N=l,D=c;var W=Object.freeze({createAreaEventHandler:function(_,A,e){var v=this;return function(e){var t=v.state.areaForAreaId(A),r=v.state.areaProps(),i=t.state.state;switch(_){case E:i!==L&&i!==b&&(t.state.state=O,v.showAxisTickLabels(e.axisId),me.select(this).style("fill-opacity",r.hoverCircleOpacity),v.highlightArea(t,r),me.select(e.circleRef).transition(100).attr("r",r.circleProps.defaultRadius*r.circleProps.circleOverlayRadiusMult),v.showCurrentValueForSeriesAndAxis(t.props.seriesId,e.axisId));break;case R:i===O||i===T?(me.select(this).style("fill-opacity",r.defaultCircleOpacity),v.highlightAreaRemove(t,r),v.hideAxisTickLabels(e.axisId),me.select(e.circleRef).transition(100).attr("r",r.circleProps.defaultRadius),v.hideAllAxisValues(t.props.seriesId),t.state.state=P):v.state===L&&(v.state=b);break;case I:if(v.showAxisTickLabels(e.axisId),k.isFirefox){var s=this.getCTM(),a=v.selectors.drawingContext().nodes()[0].parentNode,n=a.createSVGMatrix();n.e=a.parentNode.getBoundingClientRect().x,n.f=a.parentNode.getBoundingClientRect().y,n=n.multiply(s),t.state.draggingParams={},t.state.draggingParams.tFMatrix=n.inverse(),t.state.draggingParams.svgEl=a}break;case F:i===T&&(me.select(this).style("fill-opacity",r.hoverCircleOpacity),v.highlightArea(t,r),me.select(e.circlRef).transition(100).attr("r",r.circleProps.defaultRadius*r.circleProps.circleOverlayRadiusMult)),e.dragActive=!0,t.state.dragActive=!0,v.draggingActions(t,e,this,r);break;case w:t.state.dragActive=!1,me.select(this).style("fill-opacity",r.defaultCircleOpacity),t.state.state=T,v.highlightAreaRemove(t,r),e.dragActive=!1;var o=me.event.sourceEvent,l=o.clientX,c=o.clientY,u=v.state.stateQuery.areaPoint(e.seriesId,e.axisId).circleRef.getBoundingClientRect(),d=u.x,h=u.y,p=u.width,f=u.height;(l+p<d||d<l-p||h<c-f||c+f<h)&&(v.hideVertexLabelForArea(t,r),v.hideAllAxisValues(t.props.seriesId),v.selectors.selectAllCircles().transition(500).attr("r",r.circleProps.defaultRadius),v.hideAxisTickLabels(e.axisId)),S.isFunction(r.onValueFinishChange)&&r.onValueFinishChange(t.props.seriesId);break;case C:me.event.stopPropagation();var g,x=e,m=v.state.stateQuery.currentValueFor(t.props.seriesId,x.axisId);(g=me.event.deltaY<=0?m+.01*x.range:m-.01*x.range)>=x.maxValue&&(g=x.maxValue),g<=x.minValue&&(g=x.minValue);var y=v.state.stateQuery.areaPoint(t.props.seriesId,x.axisId);y.value=g,y.cords=x.projectValueOnAxis(g),t.state.svgStringRep=t.state.points.reduce(function(e,t){return e+t.cords.x+","+t.cords.y+" "},""),v.showCurrentValueForSeriesAndAxis(t.props.seriesId,x.axisId),v.reRenderArea(t),S.isFunction(r.onValueChange)&&r.onValueChange(Object.assign({},y))}}},draggingActions:function(e,t,r,i){var s=this.state.axisById(t.axisId).props,a=me.event,n=a.x,o=a.y;if(k.isFirefox){var l=e.state.draggingParams.svgEl.createSVGPoint();l.x=me.event.sourceEvent.clientX,l.y=me.event.sourceEvent.clientY,n=(l=l.matrixTransform(e.state.draggingParams.tFMatrix)).x,o=l.y}var c=s.projectCordToAxis(n,o).x,u=s.projectCordToAxis(n,o).y;if(s.quad===N||s.quad===D){if(u<s.y2||u>s.y1)return}else if(u<s.y1||u>s.y2)return;e.state.state=L;var d=s.cordOnAxisToValue(c,u);t.value=d,t.cords=s.projectValueOnAxis(d),e.state.svgStringRep=e.state.points.reduce(function(e,t){return e+t.cords.x+","+t.cords.y+" "},""),this.showCurrentValueForSeriesAndAxis(e.props.seriesId,t.axisId),this.reRenderArea(e),S.isFunction(i.onValueChange)&&i.onValueChange(Object.assign({},t))},showVertexLabelsForArea:function(e,t){this.selectors.selectPolyVertexLabelForSeries(e.props.seriesId).style("opacity",t.areaHighlightProps.highlightedLabelOpacity)},hideVertexLabelForArea:function(e,t){this.selectors.selectPolyVertexLabelForSeries(e.props.seriesId).style("opacity",t.areaHighlightProps.hiddenLabelOpacity)},highlightArea:function(e,t){this.selectors.selectAllPolygons().transition(200).style("fill-opacity",t.areaHighlightProps.hiddenAreaOpacity).style("stroke-opacity",t.areaHighlightProps.hiddenStrokeOpacity),this.showVertexLabelsForArea(e,t),this.selectors.selectPolygonForSeries(e.props.seriesId).transition(200).style("fill-opacity",t.areaHighlightProps.highlightedAreaOpacity).style("stroke-opacity",t.areaHighlightProps.highlightedStrokeOpacity),e.state.currentAreaOpacity=t.areaHighlightProps.highlightedAreaOpacity},highlightAreaRemove:function(e,t){this.selectors.selectAllPolygons().transition(200).style("fill-opacity",t.areaHighlightProps.defaultAreaOpacity).style("stroke-opacity",t.areaHighlightProps.defaultStrokeOpacity),this.hideVertexLabelForArea(e,t),e.state.currentAreaOpacity=t.areaHighlightProps.defaultAreaOpacity},reRenderArea:function(e){var t=Object.assign({},this.state.renderConstructProps(),{eventHandlerFactory:this}),r=new v(t);r.removeAreaForSeries(e.props.seriesId),r.render(this.state.areaRenderProps(),[e])},reRenderAllAreas:function(){var t=this;this.state.getAreaDatums().forEach(function(e){return t.reRenderArea(e)})}});var H=Object.freeze({hideAxisTickLabels:function(e){var t=this.state.axisById(e);me.selectAll(t.percLabels).transition(200).style("opacity",0)},hideAllAxisValues:function(){var t=this;this.state.getAxisDatums().forEach(function(e){t.selectors.labelValueForAxis(e.axisId).text("")})},onAxisLabelOver:function(){var s=this;return function(e){var t=s.state.stateQuery.wheelLabelAreaId();t&&s.showCurrentValueForSeriesAndAxis(t,e.axisId),s.state.stateQuery.onWheelAxisFn&&s.state.stateQuery.onWheelAxisFn(),s.showAxisTickLabels(e.axisId);var r=s.state.axisById(e.axisId),i=s.state.axisProps;me.select(r.axisLine).transition(200).style("stroke-width","0.8px").style("stroke",i.lineProps["hover-fill"]),me.selectAll(r.labelLines).style("fill",i.axisLabelProps["hover-fill"]),s.state.onAxisLabelOverFn()&&s.state.onAxisLabelOverFn(e.axisId)}},onAxisLabelOut:function(){var i=this;return function(e){i.hideAllAxisValues(),i.hideAxisTickLabels(e.axisId);var t=i.state.axisById(e.axisId),r=i.state.axisProps;me.select(t.axisLine).transition(200).style("stroke-width","0.8px").style("stroke",r.lineProps.fill),me.selectAll(t.labelLines).style("fill",r.axisLabelProps.fill),i.state.stateQuery.onAxisLabelOutFn&&i.state.stateQuery.onAxisLabelOutFn(e.axisId)}},showCurrentValuesForSeries:function(e){var t=this,r=this.state.areaForAreaId(e).state.points.reduce(function(e,t){return e[t.axisId]=t.value,e},{}),i=me.format(".2");Object.keys(r).forEach(function(e){t.selectors.labelValueForAxis(e).text(i(r[e]))})},showAxisTickLabels:function(e){var t=this.state.axisById(e);me.selectAll(t.percLabels).transition(200).style("opacity",.9)},showCurrentValueForSeriesAndAxis:function(e,t){var r=me.format(".2"),i=this.state.areaForAreaId(e).state.points.reduce(function(e,t){return e[t.axisId]=t.value,e},{});this.selectors.labelValueForAxis(t).text(r(i[t]))},onZoomForAxis:function(e,t){var r,i,s,a,n=this.state.axisById(t),o=n.props.tickFontLop(e);this.selectors.selectAxisTicksForAxis(n.props.axisId).style("font-size",o+"px"),2<e?(i=n.props.projectValueOnAxis(n.props.minValue+n.props.range*n.props.axisLabelFactorLop(e)).x,r=n.props.projectValueOnAxis(n.props.minValue+n.props.range*n.props.axisLabelFactorLop(e)).y,s=n.props.axisTitleSizeLopMin(e)+"px",a=n.props.labelLineSpaceLopMin(e),me.selectAll(n.zoomedLabelLines).attr("x",i).attr("y",r).attr("dy",function(e,t){return a*t}).style("font-size",s).style("fill-opacity",1),me.select(n.labelValue).style("fill-opacity",0),me.selectAll(n.labelLines).style("fill-opacity",0)):(i=n.props.axisLabelCords().x,r=n.props.axisLabelCords().y,s=n.props.axisTitleSizeLop(e)+"px",a=n.props.labelLineSpacingLop(e),me.selectAll(n.zoomedLabelLines).style("fill-opacity",0),me.select(n.labelValue).style("fill-opacity",1).attr("dy",function(e,t){return a*n.labelLines.length}).style("font-size",s),me.selectAll(n.labelLines).attr("x",i).attr("y",r).attr("dy",function(e,t){return a*t}).style("font-size",s).style("fill-opacity",1)),me.select(n.axisLabelEl).attr("transform",function(){return"rotate("+n.props.axisLabelRotation()+","+i+","+r+")"})}});var j=Object.freeze({onLegendOver:function(){var i=this;return function(e){var t=i.state.seriesById(e.props.seriesId);me.select(t.legendRect).attr("opacity",1),t.legendLabelLines.map(function(e){return me.select(e)}).forEach(function(e){e.attr("fill",t.props.fillColor),e.attr("font-weight","bold")});var r=i.state.areaProps();i.highlightArea(t,r),i.showCurrentValuesForSeries(t.props.seriesId)}},onLegendOut:function(){var s=this;return function(e){var t=s.state.seriesById(e.props.seriesId);t.legendLabelLines.map(function(e){return me.select(e)}).forEach(function(e){e.attr("fill",t.props.fillColor),e.attr("font-weight","bold")}),me.select(t.legendRect).attr("opacity",.7);var r=s.state.areaProps();s.highlightAreaRemove(t,r),s.hideAllAxisValues();var i=s.state.legendProps();t.legendLabelLines.map(function(e){return me.select(e)}).forEach(function(e){e.attr("fill",i.labelTextProperties.fill),e.attr("font-weight","normal")})}}});var M=Object.freeze({zoomHandler:function(o){var l=this;return function(){var e=l.state.calculatedDims,t=e.paddingW,r=e.paddingH,i=l.state.stateQuery.zoomProps(),s=me.event.transform.k;if(k.isFirefox){var a=s>i.scaleExtent.minZoom?.1*s:i.scaleExtent.minZoom,n=s<i.scaleExtent.maxZoom?1.1*s:i.scaleExtent.maxZoom;o.scaleExtent([a,n])}l.state.selectors.drawingContext().attr("transform",me.event.transform),l.state.stateSetters.updateSizesOnZoomForAllAreas(s),l.state.stateQuery.axisIds().forEach(function(e){l.onZoomForAxis(s,e)}),l.reRenderAllAreas(),1===me.event.transform.k&&l.state.selectors.selectRootG().attr("transform","translate("+t+","+r+")")}}}),G=function e(t){var r=this;s(this,e),this.state=t,this.selectors=this.state.selectors,S.each(W,function(e,t){r[t]=r[t].bind(r)}),S.each(H,function(e,t){r[t]=r[t].bind(r)}),S.each(j,function(e,t){r[t]=r[t].bind(r)}),S.each(M,function(e,t){r[t]=r[t].bind(r)})};return Object.assign(G.prototype,W),Object.assign(G.prototype,H),Object.assign(G.prototype,j),Object.assign(G.prototype,M),function(){function t(e){s(this,t),this.__construct(e)}return e(t,[{key:"__construct",value:function(e){this.state=new _(e),this.eventHandlerFactory=new G(this.state),this.renderEngine=new z(Object.assign({},this.state.renderConstructProps(),{eventHandlerFactory:this.eventHandlerFactory}))}},{key:"render",value:function(){this.renderEngine.init(this.state.renderInitProps()),this.renderEngine.renderAxis(this.state.axisRenderProps(),this.state.getAxisDatums()).renderArea(this.state.areaRenderProps(),this.state.getAreaDatums()).renderLegend()}},{key:"reRenderWithNewOptions",value:function(e){this.delete(),this.__construct(e),this.render()}},{key:"delete",value:function(){var e=this.state.getAreaDatums().map(function(e){return e.props.seriesId});this.renderEngine.areaRender.removeArea(e),this.renderEngine.legendRender.removeLegend(e);var t=this.state.getAxisDatums().map(function(e){return e.axisId});this.renderEngine.axisRender.removeAxis(t),this.state.selectors.selectRootSvg().remove()}},{key:"showAxisLabelValues",value:function(e){this.eventHandlerFactory.showCurrentValuesForSeries(e)}},{key:"hideAxisLabelValues",value:function(){this.eventHandlerFactory.hideAllAxisValues()}}]),t}()});
